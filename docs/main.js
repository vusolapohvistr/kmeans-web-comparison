(()=>{"use strict";var e,n,t,r,o={179:(e,n,t)=>{t.a(e,(async(e,r)=>{try{t.r(n),t.d(n,{__wbg_get_44be0491f933a435:()=>a.C9,__wbg_isArray_4c24b343cb13cfb1:()=>a.g9,__wbg_length_fff51ee6522a1a18:()=>a.Nt,__wbg_new_b51585de1b234aff:()=>a.Tc,__wbg_newwithargs_a0432b7780c1dfa1:()=>a.UA,__wbg_newwithlength_3ec098a360da1909:()=>a.cm,__wbg_newwithlength_850a1ef87dba4897:()=>a.WK,__wbg_push_ca1c26067ef907ac:()=>a.SU,__wbg_random_5f61cd0d6777a993:()=>a.mI,__wbg_set_092e06b0f9d71865:()=>a.R9,__wbg_set_wasm:()=>a.oT,__wbg_setindex_39c123f1deccc566:()=>a.Q3,__wbindgen_debug_string:()=>a.fY,__wbindgen_number_get:()=>a.M1,__wbindgen_number_new:()=>a.pT,__wbindgen_object_drop_ref:()=>a.ug,__wbindgen_string_new:()=>a.h4,__wbindgen_throw:()=>a.Or,kmeans:()=>a.aB,kmeans_rgb:()=>a.GN});var o=t(689),a=t(293),i=e([o]);o=(i.then?(await i)():i)[0],(0,a.oT)(o),r()}catch(e){r(e)}}))},293:(e,n,t)=>{let r;function o(e){r=e}t.d(n,{C9:()=>T,GN:()=>x,M1:()=>M,Nt:()=>E,Or:()=>F,Q3:()=>W,R9:()=>D,SU:()=>P,Tc:()=>O,UA:()=>U,WK:()=>N,aB:()=>k,cm:()=>$,fY:()=>C,g9:()=>I,h4:()=>A,mI:()=>B,oT:()=>o,pT:()=>j,ug:()=>S}),e=t.hmd(e);const a=new Array(128).fill(void 0);function i(e){return a[e]}function c(e){return null==e}a.push(void 0,null,!0,!1);let u=null,_=null;function f(){return null!==_&&0!==_.byteLength||(_=new Int32Array(r.memory.buffer)),_}let s=a.length;function l(e){const n=i(e);return function(e){e<132||(a[e]=s,s=e)}(e),n}let d=new("undefined"==typeof TextDecoder?(0,e.require)("util").TextDecoder:TextDecoder)("utf-8",{ignoreBOM:!0,fatal:!0});d.decode();let b=null;function g(){return null!==b&&0!==b.byteLength||(b=new Uint8Array(r.memory.buffer)),b}function h(e,n){return e>>>=0,d.decode(g().subarray(e,e+n))}function w(e){s===a.length&&a.push(a.length+1);const n=s;return s=a[n],a[n]=e,n}function m(e){const n=typeof e;if("number"==n||"boolean"==n||null==e)return`${e}`;if("string"==n)return`"${e}"`;if("symbol"==n){const n=e.description;return null==n?"Symbol":`Symbol(${n})`}if("function"==n){const n=e.name;return"string"==typeof n&&n.length>0?`Function(${n})`:"Function"}if(Array.isArray(e)){const n=e.length;let t="[";n>0&&(t+=m(e[0]));for(let r=1;r<n;r++)t+=", "+m(e[r]);return t+="]",t}const t=/\[object ([^\]]+)\]/.exec(toString.call(e));let r;if(!(t.length>1))return toString.call(e);if(r=t[1],"Object"==r)try{return"Object("+JSON.stringify(e)+")"}catch(e){return"Object"}return e instanceof Error?`${e.name}: ${e.message}\n${e.stack}`:r}let p=0,y=new("undefined"==typeof TextEncoder?(0,e.require)("util").TextEncoder:TextEncoder)("utf-8");const v="function"==typeof y.encodeInto?function(e,n){return y.encodeInto(e,n)}:function(e,n){const t=y.encode(e);return n.set(t),{read:e.length,written:t.length}};function x(e,n,t,o){try{const b=r.__wbindgen_add_to_stack_pointer(-16),h=function(e,n){const t=n(1*e.length,1)>>>0;return g().set(e,t/1),p=e.length,t}(e,r.__wbindgen_export_0),w=p;r.kmeans_rgb(b,h,w,n,t,!c(o),c(o)?0:o);var a=f()[b/4+0],i=f()[b/4+1],u=f()[b/4+2];if(f()[b/4+3])throw l(u);var _=(s=a,d=i,s>>>=0,g().subarray(s/1,s/1+d)).slice();return r.__wbindgen_export_2(a,1*i),_}finally{r.__wbindgen_add_to_stack_pointer(16)}var s,d}function k(e,n,t,o){try{const u=r.__wbindgen_add_to_stack_pointer(-16);r.kmeans(u,w(e),n,t,!c(o),c(o)?0:o);var a=f()[u/4+0],i=f()[u/4+1];if(f()[u/4+2])throw l(i);return l(a)}finally{r.__wbindgen_add_to_stack_pointer(16)}}function M(e,n){const t=i(n),o="number"==typeof t?t:void 0;(null!==u&&0!==u.byteLength||(u=new Float64Array(r.memory.buffer)),u)[e/8+1]=c(o)?0:o,f()[e/4+0]=!c(o)}function S(e){l(e)}function A(e,n){return w(h(e,n))}function j(e){return w(e)}function T(e,n){return w(i(e)[n>>>0])}function E(e){return i(e).length}function O(){return w(new Object)}function $(e){return w(new Array(e>>>0))}function I(e){return Array.isArray(i(e))}function P(e,n){return i(e).push(i(n))}function U(e,n,t,r){return w(new Function(h(e,n),h(t,r)))}const B="function"==typeof Math.random?Math.random:("Math.random",()=>{throw new Error("Math.random is not defined")});function D(){return function(e,n){try{return function(e,n,t){return Reflect.set(i(e),i(n),i(t))}.apply(this,n)}catch(e){r.__wbindgen_export_3(w(e))}}(0,arguments)}function N(e){return w(new Uint32Array(e>>>0))}function W(e,n,t){i(e)[n>>>0]=t>>>0}function C(e,n){const t=function(e,n,t){if(void 0===t){const t=y.encode(e),r=n(t.length,1)>>>0;return g().subarray(r,r+t.length).set(t),p=t.length,r}let r=e.length,o=n(r,1)>>>0;const a=g();let i=0;for(;i<r;i++){const n=e.charCodeAt(i);if(n>127)break;a[o+i]=n}if(i!==r){0!==i&&(e=e.slice(i)),o=t(o,r,r=i+3*e.length,1)>>>0;const n=g().subarray(o+i,o+r);i+=v(e,n).written}return p=i,o}(m(i(n)),r.__wbindgen_export_0,r.__wbindgen_export_1),o=p;f()[e/4+1]=o,f()[e/4+0]=t}function F(e,n){throw new Error(h(e,n))}},697:e=>{e.exports={eudist:function(e,n){for(var t=e.length,r=0,o=0;o<t;o++){var a=(e[o]||0)-(n[o]||0);r+=a*a}return r},mandist:function(e,n){for(var t=e.length,r=0,o=0,a=0;a<t;a++)r+=(o=(e[a]||0)-(n[a]||0))>=0?o:-o;return r},dist:function(e,n,t){var r=Math.abs(e-n);return t?r:r*r}}},35:(e,n,t)=>{var r=t(697),o=r.eudist,a=r.dist;e.exports={kmrand:function(e,n){for(var t={},r=[],o=n<<2,a=e.length,i=e[0].length>0;r.length<n&&o-- >0;){var c=e[Math.floor(Math.random()*a)],u=i?c.join("_"):"".concat(c);t[u]||(t[u]=!0,r.push(c))}if(r.length<n)throw new Error("Error initializating clusters");return r},kmpp:function(e,n,t){var r=t||(e[0].length?o:a),i=[],c=e.length,u=e[0].length>0,_=e[Math.floor(Math.random()*c)];for(u?_.join("_"):"".concat(_),i.push(_);i.length<n;){for(var f=[],s=i.length,l=0,d=[],b=0;b<c;b++){for(var g=1/0,h=0;h<s;h++){var w=r(e[b],i[h]);w<=g&&(g=w)}f[b]=g}for(var m=0;m<c;m++)l+=f[m];for(var p=0;p<c;p++)d[p]={i:p,v:e[p],pr:f[p]/l,cs:0};d.sort((function(e,n){return e.pr-n.pr})),d[0].cs=d[0].pr;for(var y=1;y<c;y++)d[y].cs=d[y-1].cs+d[y].pr;for(var v=Math.random(),x=0;x<c-1&&d[x++].cs<v;);i.push(d[x-1].v)}return i}}},160:(e,n,t)=>{var r=t(697),o=t(35),a=r.eudist,i=(r.mandist,r.dist,o.kmrand),c=o.kmpp;function u(e,n,t){t=t||[];for(var r=0;r<e;r++)t[r]=n;return t}function _(e,n){for(var t=Array.isArray(e),r=this.centroids,o=r.length,i=1/0,c=0,u=0;u<o;u++){var _=n?n(e,r[u]):t?a(e,r[u]):Math.abs(e-r[u]);_<=i&&(i=_,c=u)}return{idx:c,centroid:r[c]}}e.exports=function(e,n,t,r,o){var f=[],s=[],l=[],d=[],b=!1,g=r||1e4,h=e.length,w=e[0].length,m=w>0,p=[];if(t)f="kmrand"==t?i(e,n):"kmpp"==t?c(e,n,o):t;else for(var y={},v=0;f.length<n;){var x=Math.floor(Math.random()*h);y[x]||(y[x]=!0,f[v++]=e[x])}do{u(n,0,p);for(var k=0;k<h;k++){for(var M=1/0,S=0,A=0;A<n;A++)(d=o?o(e[k],f[A]):m?a(e[k],f[A]):Math.abs(e[k]-f[A]))<=M&&(M=d,S=A);l[k]=S,p[S]++}var j=[];if(s=[],m)for(var T=0;T<n;T++)j[T]=u(w,0,j[T]),s[T]=f[T];else for(var E=0;E<n;E++)j[E]=0,s[E]=f[E];if(m){for(var O=0;O<n;O++)f[O]=[];for(var $=0;$<h;$++)for(var I=j[l[$]],P=e[$],U=0;U<w;U++)I[U]+=P[U];b=!0;for(var B=0;B<n;B++){for(var D=f[B],N=j[B],W=s[B],C=p[B],F=0;F<w;F++)D[F]=N[F]/C||0;if(b)for(var R=0;R<w;R++)if(W[R]!=D[R]){b=!1;break}}}else{for(var q=0;q<h;q++)j[l[q]]+=e[q];for(var K=0;K<n;K++)f[K]=j[K]/p[K]||0;b=!0;for(var L=0;L<n;L++)if(s[L]!=f[L]){b=!1;break}}b=b||--g<=0}while(!b);return{it:(r||1e4)-g,k:n,idxs:l,centroids:f,test:_}}},607:function(e,n,t){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(n,"__esModule",{value:!0});const o=r(t(160)),a=r(t(179));function i(e,n,t){const r=document.getElementById(e),o=r.height,a=r.width,i=r.getContext("2d"),c=n.reduce(((e,n)=>n[0]<e[0]?n:e)),u=n.reduce(((e,n)=>n[0]>e[0]?n:e)),_=n.reduce(((e,n)=>n[1]>e[1]?n:e)),f=n.reduce(((e,n)=>n[1]<e[1]?n:e));function s(e){return[(t=e[0],Math.floor(a*((t-c[0])/(u[0]-c[0])))),(n=e[1],Math.floor(o*((n-f[1])/(_[1]-f[1]))))];var n,t}function l(e,n){i.fillStyle=0===n?"red":1===n?"blue":2===n?"green":"black",i.fillRect(e[0],e[1],2,2)}console.log(c,u,_,f);for(const[e,r]of n.entries())l(s(r),t[e])}function c(e,n,t){return new Array(t).fill(0).map((()=>function(e,n){const t=Math.random()*n,r=2*Math.random()*Math.PI;return[e[0]+t*Math.sin(r),e[1]+t*Math.cos(r)]}(e,n)))}(async()=>{const e=(await a.default).kmeans,n=((await a.default).kmeans_rgb,function(){const e=c([-1,2],1,1e4),n=c([1,2],1,1e4),t=c([0,0],2,2e4);return e.concat(n).concat(t)}()),t=Date.now(),r=(0,o.default)(n,3,null,1e4);document.getElementById("skmeans-result").innerText=`skmeans took ${Date.now()-t}ms`,i("skmeans",n,r.idxs);const u=Date.now(),_=e(n,3,1e4,1e-11);document.getElementById("kmeans-wasm-result").innerText=`kmeans-wasm took ${Date.now()-u}ms`,i("kmeansWasm",n,_.idxs)})()},689:(e,n,t)=>{var r=t(293);e.exports=t.v(n,e.id,"16f51994c355dc01280b",{"./kmeans_wasm_bg.js":{__wbindgen_number_get:r.M1,__wbindgen_object_drop_ref:r.ug,__wbindgen_string_new:r.h4,__wbindgen_number_new:r.pT,__wbg_get_44be0491f933a435:r.C9,__wbg_length_fff51ee6522a1a18:r.Nt,__wbg_new_b51585de1b234aff:r.Tc,__wbg_newwithlength_3ec098a360da1909:r.cm,__wbg_isArray_4c24b343cb13cfb1:r.g9,__wbg_push_ca1c26067ef907ac:r.SU,__wbg_newwithargs_a0432b7780c1dfa1:r.UA,__wbg_random_5f61cd0d6777a993:r.mI,__wbg_set_092e06b0f9d71865:r.R9,__wbg_newwithlength_850a1ef87dba4897:r.WK,__wbg_setindex_39c123f1deccc566:r.Q3,__wbindgen_debug_string:r.fY,__wbindgen_throw:r.Or}})}},a={};function i(e){var n=a[e];if(void 0!==n)return n.exports;var t=a[e]={id:e,loaded:!1,exports:{}};return o[e].call(t.exports,t,t.exports,i),t.loaded=!0,t.exports}e="function"==typeof Symbol?Symbol("webpack queues"):"__webpack_queues__",n="function"==typeof Symbol?Symbol("webpack exports"):"__webpack_exports__",t="function"==typeof Symbol?Symbol("webpack error"):"__webpack_error__",r=e=>{e&&!e.d&&(e.d=1,e.forEach((e=>e.r--)),e.forEach((e=>e.r--?e.r++:e())))},i.a=(o,a,i)=>{var c;i&&((c=[]).d=1);var u,_,f,s=new Set,l=o.exports,d=new Promise(((e,n)=>{f=n,_=e}));d[n]=l,d[e]=e=>(c&&e(c),s.forEach(e),d.catch((e=>{}))),o.exports=d,a((o=>{var a;u=(o=>o.map((o=>{if(null!==o&&"object"==typeof o){if(o[e])return o;if(o.then){var a=[];a.d=0,o.then((e=>{i[n]=e,r(a)}),(e=>{i[t]=e,r(a)}));var i={};return i[e]=e=>e(a),i}}var c={};return c[e]=e=>{},c[n]=o,c})))(o);var i=()=>u.map((e=>{if(e[t])throw e[t];return e[n]})),_=new Promise((n=>{(a=()=>n(i)).r=0;var t=e=>e!==c&&!s.has(e)&&(s.add(e),e&&!e.d&&(a.r++,e.push(a)));u.map((n=>n[e](t)))}));return a.r?_:i()}),(e=>(e?f(d[t]=e):_(l),r(c)))),c&&(c.d=0)},i.d=(e,n)=>{for(var t in n)i.o(n,t)&&!i.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:n[t]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),i.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.v=(e,n,t,r)=>{var o=fetch(i.p+""+t+".module.wasm");return"function"==typeof WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(o,r).then((n=>Object.assign(e,n.instance.exports))):o.then((e=>e.arrayBuffer())).then((e=>WebAssembly.instantiate(e,r))).then((n=>Object.assign(e,n.instance.exports)))},(()=>{var e;i.g.importScripts&&(e=i.g.location+"");var n=i.g.document;if(!e&&n&&(n.currentScript&&(e=n.currentScript.src),!e)){var t=n.getElementsByTagName("script");if(t.length)for(var r=t.length-1;r>-1&&!e;)e=t[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),i.p=e})(),i(607)})();